{
  "data": [
    {
      "id": "4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_CAPA",
      "type": "file_behaviour",
      "links": {
        "self": "https://www.virustotal.com/api/v3/file_behaviours/4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_CAPA"
      },
      "attributes": {
        "has_pcap": false,
        "mbc": [
          {
            "objective": "Operating System",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "create or open registry key"
              }
            ],
            "id": "C0036.004",
            "behavior": "Registry",
            "method": "Create Registry Key"
          },
          {
            "objective": "Operating System",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "create or open registry key"
              }
            ],
            "id": "C0036.003",
            "behavior": "Registry",
            "method": "Open Registry Key"
          },
          {
            "objective": "Defense Evasion",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "encode data using XOR"
              }
            ],
            "id": "E1027.m02",
            "behavior": "Obfuscated Files or Information",
            "method": "Encoding-Standard Algorithm"
          },
          {
            "objective": "Data",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "encode data using XOR"
              }
            ],
            "id": "C0026.002",
            "behavior": "Encode Data",
            "method": "XOR"
          },
          {
            "objective": "Anti-Behavioral Analysis",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "delay execution"
              }
            ],
            "id": "B0003.003",
            "behavior": "Dynamic Analysis Evasion",
            "method": "Delayed Execution"
          },
          {
            "objective": "Operating System",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "query or enumerate registry value"
              }
            ],
            "id": "C0036.006",
            "behavior": "Registry",
            "method": "Query Registry Value"
          },
          {
            "objective": "Discovery",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "get disk information"
              }
            ],
            "id": "E1082",
            "behavior": "System Information Discovery"
          },
          {
            "objective": "File System",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "write file on Windows"
              }
            ],
            "id": "C0052",
            "behavior": "Writes File"
          },
          {
            "objective": "File System",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "read file on Windows"
              }
            ],
            "id": "C0051",
            "behavior": "Read File"
          },
          {
            "objective": "Discovery",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "check OS version"
              }
            ],
            "id": "E1082",
            "behavior": "System Information Discovery"
          },
          {
            "objective": "Discovery",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "get hostname"
              }
            ],
            "id": "E1082",
            "behavior": "System Information Discovery"
          },
          {
            "objective": "Communication",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "resolve DNS"
              }
            ],
            "id": "C0011.001",
            "behavior": "DNS Communication",
            "method": "Resolve"
          },
          {
            "objective": "Communication",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "initialize Winsock library"
              }
            ],
            "id": "C0001.009",
            "behavior": "Socket Communication",
            "method": "Initialize Winsock Library"
          },
          {
            "objective": "Anti-Behavioral Analysis",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "reference anti-VM strings"
              }
            ],
            "id": "B0009",
            "behavior": "Virtual Machine Detection"
          }
        ],
        "behash": "830747389535dfdfe68402304bc52563",
        "last_modification_date": 1707523082,
        "has_evtx": false,
        "has_memdump": false,
        "has_html_report": false,
        "mitre_attack_techniques": [
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "encode data using XOR"
              }
            ],
            "signature_description": "encode data using XOR",
            "id": "T1027",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "query or enumerate registry value"
              }
            ],
            "signature_description": "query or enumerate registry value",
            "id": "T1012",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "get disk information"
              }
            ],
            "signature_description": "get disk information",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "link function at runtime on Windows"
              }
            ],
            "signature_description": "link function at runtime on Windows",
            "id": "T1129",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "get system information on Windows"
              }
            ],
            "signature_description": "get system information on Windows",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "check OS version"
              }
            ],
            "signature_description": "check OS version",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "get CPU information"
              }
            ],
            "signature_description": "get CPU information",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "get hostname"
              }
            ],
            "signature_description": "get hostname",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "reference anti-VM strings"
              }
            ],
            "signature_description": "reference anti-VM strings",
            "id": "T1497.001",
            "severity": "IMPACT_SEVERITY_INFO"
          }
        ],
        "signature_matches": [
          {
            "format": "SIG_FORMAT_CAPA",
            "rule_src": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n",
            "name": "create or open registry key",
            "authors": [
              "michael.hunhoff@mandiant.com",
              "anushka.virgaonkar@mandiant.com"
            ]
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
            "name": "encode data using XOR",
            "description": "data-manipulation/encoding/xor"
          },
          {
            "refs": [
              {
                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
              },
              {
                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
              }
            ],
            "format": "SIG_FORMAT_CAPA",
            "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
            "name": "delay execution",
            "authors": [
              "michael.hunhoff@mandiant.com",
              "@ramen0x3f"
            ]
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
            "name": "contain loop",
            "authors": [
              "moritz.raabe@mandiant.com"
            ]
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "william.ballenthin@mandiant.com",
              "michael.hunhoff@mandiant.com",
              "anushka.virgaonkar@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n",
            "name": "query or enumerate registry value",
            "description": "host-interaction/registry"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "rule_src": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n      - api: GetProductInfo\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - or:\n              - offset: 0xA4 = PEB->OSMajorVersion\n              - offset: 0xA8 = PEB->OSMinorVersion\n              - offset: 0xAC = PEB->OSBuildNumber\n          - and:\n            - arch: amd64\n            - or:\n              - offset: 0x118 = PEB->OSMajorVersion\n              - offset: 0x11C = PEB->OSMinorVersion\n              - offset: 0x120 = PEB->OSBuildNumber\n",
            "name": "get OS version",
            "authors": [
              "@mr-tz"
            ]
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com",
              "anushka.virgaonkar@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n",
            "name": "get disk information",
            "description": "host-interaction/hardware/storage"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "william.ballenthin@mandiant.com",
              "anushka.virgaonkar@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n",
            "name": "write file on Windows",
            "description": "host-interaction/file-system/write"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com",
              "anushka.virgaonkar@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n",
            "name": "read file on Windows",
            "description": "host-interaction/file-system/read"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com",
              "michael.hunhoff@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n",
            "name": "link function at runtime on Windows",
            "description": "linking/runtime-linking"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com",
              "joakim@intezer.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: get system information on Windows\n    namespace: host-interaction/os/info\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetSystemInfo\n        - api: kernel32.GetNativeSystemInfo\n        - api: NtQuerySystemInformation\n        - api: NtQuerySystemInformationEx\n        - api: ntdll.RtlGetNativeSystemInformation\n        - api: ZwQuerySystemInformation\n        - api: ZwQuerySystemInformationEx\n",
            "name": "get system information on Windows",
            "description": "host-interaction/os/info"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "michael.hunhoff@mandiant.com",
              "johnk3r"
            ],
            "rule_src": "rule:\n  meta:\n    name: check OS version\n    namespace: host-interaction/os/version\n    authors:\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - and:\n      - match: get OS version\n      - or:\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 5 = Windows 2000\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - or:\n                - number: 0\n                - number: 1 = Windows XP\n                - number: 2 = Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 6 = Windows Vista / Windows Server 2008\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - or:\n                - number: 0\n                - number: 1 = Windows Server 2008 R2 / Windows 7\n                - number: 2 = Windows Server 2012 / Windows 8\n                - number: 3 = Windows Server 2012 R2 / Windows 8.1\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 10 = Windows Server 2016 / Windows Server 2019 / Windows 10\n          - optional:\n            - instruction:\n              - mnemonic: cmp\n              - number: 0\n",
            "name": "check OS version",
            "description": "host-interaction/os/version"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com",
              "joakim@intezer.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: get CPU information\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: query or enumerate registry value\n        - string: /Hardware\\\\Description\\\\System\\\\CentralProcessor/i\n      - and:\n        - os: linux\n        - match: host-interaction/file-system/read\n        - string: \"/proc/cpuinfo\"\n      - and:\n        - os: linux\n        - api: system\n        - substring: \"/proc/cpuinfo\"\n",
            "name": "get CPU information",
            "description": "host-interaction/hardware/cpu"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com",
              "joakim@intezer.com",
              "anushka.virgaonkar@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n",
            "name": "get hostname",
            "description": "host-interaction/os/hostname"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "william.ballenthin@mandiant.com",
              "johnk3r",
              "joakim@intezer.com",
              "michael.hunhoff@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: resolve DNS\n    namespace: communication/dns\n    authors:\n      - william.ballenthin@mandiant.com\n      - johnk3r\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::DNS Communication::Resolve [C0011.001]\n    examples:\n      - 17264e3126a97c319a6a0c61e6da951e:0x5FDC25D0\n  features:\n    - or:\n      - api: ws2_32.gethostbyname\n      - api: DnsQuery_A\n      - api: DnsQuery_W\n      - api: DnsQuery_UTF8\n      - api: DnsQueryEx\n      - api: getaddrinfo\n      - api: GetAddrInfo\n      - api: GetAddrInfoEx\n      - api: gethostbyname\n      - api: getaddrinfo\n      - api: getnameinfo\n      - api: gethostent\n      - api: System.Net.Dns::GetHostAddresses\n",
            "name": "resolve DNS",
            "description": "communication/dns"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "michael.hunhoff@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: initialize Winsock library\n    namespace: communication/socket\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\n  features:\n    - and:\n      - api: ws2_32.WSAStartup\n",
            "name": "initialize Winsock library",
            "description": "communication/socket"
          },
          {
            "format": "SIG_FORMAT_CAPA",
            "authors": [
              "moritz.raabe@mandiant.com"
            ],
            "rule_src": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n",
            "name": "contains PDB path",
            "description": "executable/pe/pdb"
          },
          {
            "description": "anti-analysis/anti-vm/vm-detection",
            "format": "SIG_FORMAT_CAPA",
            "refs": [
              {
                "ref": "https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*"
              },
              {
                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"
              }
            ],
            "rule_src": "rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx.dll/i\n        description: AVG\n      - string: /avghooka.dll/i\n        description: AVG\n      - string: /snxhk.dll/i\n        description: Avast\n      - string: /pstorec.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck.dll/i\n        description: Virtual PC\n      - string: /wpespy.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample.exe/i\n      - string: /bot.exe/i\n      - string: /sandbox.exe/i\n      - string: /malware.exe/i\n      - string: /test.exe/i\n      - string: /klavme.exe/i\n      - string: /myapp.exe/i\n      - string: /testapp.exe/i\n",
            "authors": [
              "moritz.raabe@mandiant.com"
            ],
            "name": "reference anti-VM strings"
          }
        ],
        "sandbox_name": "CAPA",
        "analysis_date": 1707523082
      }
    },
    {
      "id": "4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_Microsoft Sysinternals",
      "type": "file_behaviour",
      "links": {
        "self": "https://www.virustotal.com/api/v3/file_behaviours/4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_Microsoft Sysinternals"
      },
      "attributes": {
        "processes_tree": [
          {
            "process_id": "2956",
            "name": "%WINDIR%\\explorer.exe",
            "children": [
              {
                "process_id": "2624",
                "name": "%SAMPLEPATH%\\LicRCmd.exe"
              }
            ]
          },
          {
            "process_id": "624",
            "name": "C:\\Windows\\System32\\svchost.exe",
            "children": [
              {
                "process_id": "3956",
                "name": "C:\\Windows\\System32\\wuapihost.exe"
              }
            ]
          }
        ],
        "has_pcap": false,
        "command_executions": [
          "\"%SAMPLEPATH%\\LicRCmd.exe\" ",
          "C:\\Windows\\System32\\wuapihost.exe -Embedding"
        ],
        "files_dropped": [
          {
            "path": "%SAMPLEPATH%\\WIN-5E07COS9ALR.lrm"
          },
          {
            "path": "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER175B.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER175B.tmp.WERInternalMetadata.xml"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1836.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1836.tmp.csv"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1866.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1866.tmp.txt"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E61.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E61.tmp.WERInternalMetadata.xml"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E72.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E72.tmp.csv"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E82.tmp"
          },
          {
            "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E82.tmp.txt"
          },
          {
            "path": "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
          }
        ],
        "behash": "8c108291418f6740188a756bdcd892d2",
        "ip_traffic": [
          {
            "transport_layer_protocol": "TCP",
            "destination_ip": "20.99.186.246",
            "destination_port": 443
          },
          {
            "transport_layer_protocol": "TCP",
            "destination_ip": "192.229.211.108",
            "destination_port": 80
          },
          {
            "transport_layer_protocol": "TCP",
            "destination_ip": "20.99.184.37",
            "destination_port": 443
          },
          {
            "transport_layer_protocol": "TCP",
            "destination_ip": "23.35.98.25",
            "destination_port": 443
          }
        ],
        "files_deleted": [
          "%USERPROFILE%\\AppData\\Local\\Microsoft\\Windows\\INetCache\\IE\\KLT1I0ZU\\update50[1].xml",
          "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER175B.tmp.WERInternalMetadata.xml",
          "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1836.tmp.csv",
          "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1866.tmp.txt",
          "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E61.tmp.WERInternalMetadata.xml",
          "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E72.tmp.csv",
          "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1E82.tmp.txt",
          "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
        ],
        "last_modification_date": 1707522712,
        "processes_created": [
          "%SAMPLEPATH%\\LicRCmd.exe",
          "C:\\Windows\\System32\\wuapihost.exe"
        ],
        "has_evtx": false,
        "has_memdump": false,
        "has_html_report": false,
        "processes_terminated": [
          "%SAMPLEPATH%\\LicRCmd.exe",
          "C:\\Windows\\System32\\conhost.exe",
          "C:\\Windows\\System32\\wuapihost.exe"
        ],
        "sandbox_name": "Microsoft Sysinternals",
        "analysis_date": 1707522712
      }
    },
    {
      "id": "4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_VirusTotal Jujubox",
      "type": "file_behaviour",
      "links": {
        "self": "https://www.virustotal.com/api/v3/file_behaviours/4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_VirusTotal Jujubox"
      },
      "attributes": {
        "files_opened": [
          "C:\\Windows\\system32\\netapi32.dll",
          "C:\\Windows\\system32\\netutils.dll",
          "C:\\Windows\\system32\\srvcli.dll",
          "C:\\Windows\\system32\\wkscli.dll",
          "C:\\Windows\\system32\\netbios.dll",
          "\\Device\\Netbios"
        ],
        "has_pcap": false,
        "files_dropped": [
          {
            "path": "C:\\Users\\<USER>\\Downloads\\\\AZURE-PC.lrm",
            "sha256": "c3b351871dab3efa4045846524f54908942b38eec591d9f1be0d3318e3d53661"
          }
        ],
        "behash": "981128524a521c6c99f70c4f1e4ac27c",
        "calls_highlighted": [
          "GetTickCount"
        ],
        "last_modification_date": 1707523077,
        "has_evtx": false,
        "has_memdump": false,
        "text_highlighted": [
          "4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628.exe"
        ],
        "has_html_report": true,
        "sandbox_name": "VirusTotal Jujubox",
        "registry_keys_opened": [
          "HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0"
        ],
        "analysis_date": 1707523077
      }
    },
    {
      "id": "4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_VirusTotal Observer",
      "type": "file_behaviour",
      "links": {
        "self": "https://www.virustotal.com/api/v3/file_behaviours/4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_VirusTotal Observer"
      },
      "attributes": {
        "has_pcap": false,
        "behash": "14999cadd4c7a42ad2bca9f7a52a2c48",
        "last_modification_date": 1707523077,
        "has_evtx": true,
        "has_memdump": false,
        "has_html_report": false,
        "files_written": [
          "C:\\Users\\<USER>\\Downloads\\AZURE-PC.lrm"
        ],
        "sandbox_name": "VirusTotal Observer",
        "analysis_date": 1707523075
      }
    },
    {
      "id": "4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_Zenbox",
      "type": "file_behaviour",
      "links": {
        "self": "https://www.virustotal.com/api/v3/file_behaviours/4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628_Zenbox"
      },
      "attributes": {
        "memory_dumps": [
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962288705.000000000064E000.00000004.00000010.00020000.00000000.sdmp",
            "size": "8192",
            "base_address": "6610944",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962340825.000000000095E000.00000004.00000010.00020000.00000000.sdmp",
            "size": "8192",
            "base_address": "9822208",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000000.960844533.0000000000DD0000.00000002.00000001.01000000.00000003.sdmp",
            "size": "4096",
            "base_address": "14483456",
            "stage": "MEM_STAGE_NEW"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962296763.000000000066A000.00000004.00000020.00020000.00000000.sdmp",
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "311"
              }
            ],
            "size": "81920",
            "base_address": "6725632",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000000.960958067.0000000000DDB000.00000002.00000001.01000000.00000003.sdmp",
            "size": "8192",
            "base_address": "14528512",
            "stage": "MEM_STAGE_NEW"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962409421.0000000000BEF000.00000004.00000010.00020000.00000000.sdmp",
            "size": "4096",
            "base_address": "12513280",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962230154.0000000000140000.00000004.00000020.00020000.00000000.sdmp",
            "size": "4096",
            "base_address": "1310720",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962264257.00000000004FC000.00000004.00000010.00020000.00000000.sdmp",
            "size": "16384",
            "base_address": "5226496",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962329687.000000000085F000.00000004.00000010.00020000.00000000.sdmp",
            "size": "4096",
            "base_address": "8777728",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962353810.000000000099D000.00000004.00000010.00020000.00000000.sdmp",
            "size": "12288",
            "base_address": "10080256",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000000.960884177.0000000000DD1000.00000020.00000001.01000000.00000003.sdmp",
            "size": "20480",
            "base_address": "14487552",
            "stage": "MEM_STAGE_NEW"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962208234.0000000000130000.00000004.00000020.00040000.00000000.sdmp",
            "size": "4096",
            "base_address": "1245184",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962296763.0000000000660000.00000004.00000020.00020000.00000000.sdmp",
            "size": "32768",
            "base_address": "6684672",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962398263.0000000000AE0000.00000004.00000020.00020000.00000000.sdmp",
            "size": "8192",
            "base_address": "11403264",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962371565.0000000000A9E000.00000004.00000010.00020000.00000000.sdmp",
            "size": "8192",
            "base_address": "11132928",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000000.960946180.0000000000DD9000.00000008.00000001.01000000.00000003.sdmp",
            "size": "4096",
            "base_address": "14520320",
            "stage": "MEM_STAGE_NEW"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000000.960931787.0000000000DD6000.00000002.00000001.01000000.00000003.sdmp",
            "size": "12288",
            "base_address": "14508032",
            "stage": "MEM_STAGE_NEW"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962384727.0000000000ADE000.00000004.00000010.00020000.00000000.sdmp",
            "size": "8192",
            "base_address": "11395072",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962252237.00000000001F0000.00000004.00000020.00020000.00000000.sdmp",
            "size": "24576",
            "base_address": "2031616",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962438064.0000000000DD0000.00000002.00000001.01000000.00000003.sdmp",
            "size": "4096",
            "base_address": "14483456",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962296763.000000000067F000.00000004.00000020.00020000.00000000.sdmp",
            "size": "12288",
            "base_address": "6811648",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962510239.0000000000DD9000.00000004.00000001.01000000.00000003.sdmp",
            "size": "4096",
            "base_address": "14520320",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962527135.0000000000DDB000.00000002.00000001.01000000.00000003.sdmp",
            "size": "8192",
            "base_address": "14528512",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962239183.00000000001BD000.00000004.00000010.00020000.00000000.sdmp",
            "size": "12288",
            "base_address": "1822720",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962276156.000000000060E000.00000004.00000010.00020000.00000000.sdmp",
            "size": "8192",
            "base_address": "6348800",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962482196.0000000000DD6000.00000002.00000001.01000000.00000003.sdmp",
            "size": "12288",
            "base_address": "14508032",
            "stage": "MEM_STAGE_EXIT"
          },
          {
            "process": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "file_name": "00000000.00000002.962457577.0000000000DD1000.00000020.00000001.01000000.00000003.sdmp",
            "size": "20480",
            "base_address": "14487552",
            "stage": "MEM_STAGE_EXIT"
          }
        ],
        "processes_tree": [
          {
            "process_id": "7992",
            "name": "C:\\Users\\user\\Desktop\\LicRCmd.exe",
            "children": [
              {
                "process_id": "8000",
                "name": "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
              }
            ]
          }
        ],
        "files_opened": [
          "C:\\Users\\user\\Desktop\\LicRCmd.exe",
          "C:\\Windows\\AppPatch\\sysmain.sdb",
          "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
          "C:\\Windows\\SYSTEM32\\ntmarta.dll",
          "C:\\Windows\\SYSTEM32\\ole32.dll",
          "C:\\Windows\\SYSTEM32\\wintypes.dll",
          "C:\\Windows\\SysWOW64\\ADVAPI32.dll",
          "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
          "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
          "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
          "C:\\Windows\\SysWOW64\\MSVCP140.dll",
          "C:\\Windows\\SysWOW64\\NETUTILS.DLL",
          "C:\\Windows\\SysWOW64\\RPCRT4.dll",
          "C:\\Windows\\SysWOW64\\SRVCLI.DLL",
          "C:\\Windows\\SysWOW64\\SspiCli.dll",
          "C:\\Windows\\SysWOW64\\VCRUNTIME140.dll",
          "C:\\Windows\\SysWOW64\\WS2_32.dll",
          "C:\\Windows\\SysWOW64\\WSOCK32.dll",
          "C:\\Windows\\SysWOW64\\apphelp.dll",
          "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
          "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
          "C:\\Windows\\SysWOW64\\msvcrt.dll",
          "C:\\Windows\\SysWOW64\\netapi32.dll",
          "C:\\Windows\\SysWOW64\\netbios.dll",
          "C:\\Windows\\SysWOW64\\ntdll.dll",
          "C:\\Windows\\SysWOW64\\sechost.dll",
          "C:\\Windows\\SysWOW64\\ucrtbase.dll",
          "C:\\Windows\\System32\\CoreMessaging.dll",
          "C:\\Windows\\System32\\CoreUIComponents.dll",
          "C:\\Windows\\System32\\TextInputFramework.dll",
          "C:\\Windows\\System32\\en-US\\user32.dll.mui",
          "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0",
          "C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.17134.1304_none_d3fbe61b7c93d9f0\\comctl32.DLL",
          "C:\\Windows\\system32\\IMM32.DLL",
          "C:\\Windows\\system32\\conhost.exe",
          "C:\\Windows\\system32\\dwmapi.dll",
          "C:\\Windows\\system32\\en-US\\conhost.exe.mui",
          "C:\\Windows\\system32\\rpcss.dll",
          "C:\\Windows\\system32\\uxtheme.dll",
          "C:\\Windows\\system32\\uxtheme.dll.Config",
          "\\Device\\ConDrv\\Server",
          "\\Device\\ConDrv\\\\Input",
          "\\Device\\ConDrv\\\\Output",
          "\\Device\\ConDrv\\\\Reference",
          "\\Device\\Netbios",
          "\\pipe\\srvsvc",
          "c:\\"
        ],
        "has_pcap": true,
        "tags": [
          "CHECKS_USER_INPUT",
          "DETECT_DEBUG_ENVIRONMENT"
        ],
        "files_dropped": [
          {
            "path": "C:\\Users\\user\\Desktop\\320946.lrm",
            "sha256": "2d69ec4e863c1f55b465ecdde06d1771eed7bedbe90c1be8c45af249bce6485b",
            "type": "TEXT"
          }
        ],
        "behash": "58db6fd087ef70d70c430a8ebf12dc47",
        "last_modification_date": 1707523599,
        "processes_created": [
          "C:\\Users\\user\\Desktop\\LicRCmd.exe",
          "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
        ],
        "verdicts": [
          "CLEAN"
        ],
        "has_evtx": true,
        "has_memdump": true,
        "has_html_report": true,
        "processes_terminated": [
          "C:\\Users\\user\\Desktop\\LicRCmd.exe"
        ],
        "mitre_attack_techniques": [
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "90"
              }
            ],
            "signature_description": "Creates files inside the user directory",
            "id": "T1036",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "311"
              }
            ],
            "signature_description": "Creates a DirectInput object (often for capturing keystrokes)",
            "id": "T1056",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "509"
              }
            ],
            "signature_description": "Reads software policies",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "refs": [
              {
                "ref": "#signature_matches",
                "value": "337"
              }
            ],
            "signature_description": "Queries the volume information (name, serial number etc) of a device",
            "id": "T1082",
            "severity": "IMPACT_SEVERITY_INFO"
          }
        ],
        "signature_matches": [
          {
            "id": "311",
            "refs": [
              {
                "ref": "#memory_dumps",
                "value": "LicRCmd.exe, 00000000.00000002.962296763.000000000066A000.00000004.00000020.00020000.00000000.sdmp"
              }
            ],
            "match_data": [
              "      <HOOK MODULE=\"DDRAW.DLL\" FUNCTION=\"DirectDrawCreateEx\"/>"
            ],
            "description": "Creates a DirectInput object (often for capturing keystrokes)",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "871",
            "match_data": [
              "Thread delayed"
            ],
            "description": "Sample execution stops while process was sleeping (likely an evasion)",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "9028",
            "match_data": [
              "EXECUTABLE_IMAGE, 32BIT_MACHINE"
            ],
            "description": "Uses 32bit PE files",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "415",
            "match_data": [
              "Section: .text IMAGE_SCN_CNT_CODE, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ"
            ],
            "description": "PE file has an executable .text section and no other executable section",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "509",
            "refs": [
              {
                "ref": "#registry_keys_opened",
                "value": "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
              }
            ],
            "match_data": [
              "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers"
            ],
            "description": "Reads software policies",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "337",
            "match_data": [
              "C:\\ VolumeInformation"
            ],
            "description": "Queries the volume information (name, serial number etc) of a device",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "411",
            "match_data": [
              "data directory type: IMAGE_DIRECTORY_ENTRY_IMPORT",
              "data directory type: IMAGE_DIRECTORY_ENTRY_RESOURCE",
              "data directory type: IMAGE_DIRECTORY_ENTRY_BASERELOC",
              "data directory type: IMAGE_DIRECTORY_ENTRY_DEBUG",
              "data directory type: IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG",
              "data directory type: IMAGE_DIRECTORY_ENTRY_IAT"
            ],
            "description": "PE file contains a mix of data directories often seen in goodware",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "715",
            "match_data": [
              "clean2.winEXE@2/1@0/0"
            ],
            "description": "Classification label",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "229",
            "match_data": [
              "C:\\Users\\user\\Desktop\\LicRCmd.exe C:\\Users\\user\\Desktop\\LicRCmd.exe",
              "C:\\Windows\\System32\\conhost.exe C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1"
            ],
            "description": "Spawns processes",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "406",
            "match_data": [
              "DYNAMIC_BASE, NX_COMPAT, TERMINAL_SERVER_AWARE"
            ],
            "description": "Contains modern PE file flags such as dynamic base (ASLR) or NX",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "95",
            "match_data": [
              "\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:8000:120:WilError_01"
            ],
            "description": "Creates mutexes",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "404",
            "match_data": [
              "certificate valid"
            ],
            "description": "PE / OLE file has a valid certificate",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "416",
            "match_data": [
              "Data directory: IMAGE_DIRECTORY_ENTRY_IMPORT is in: .rdata",
              "Data directory: IMAGE_DIRECTORY_ENTRY_RESOURCE is in: .rsrc",
              "Data directory: IMAGE_DIRECTORY_ENTRY_BASERELOC is in: .reloc",
              "Data directory: IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG is in: .rdata",
              "Data directory: IMAGE_DIRECTORY_ENTRY_IAT is in: .rdata"
            ],
            "description": "PE file contains a valid data directory to section mapping",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "203",
            "match_data": [
              "F:\\Licensing\\src\\Licrcmd\\Win32\\ReleaseMT\\Licrcmd.pdb''% source: LicRCmd.exe",
              "F:\\Licensing\\src\\Licrcmd\\Win32\\ReleaseMT\\Licrcmd.pdb source: LicRCmd.exe"
            ],
            "description": "Binary contains paths to debug symbols",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "412",
            "match_data": [
              "data directory type: IMAGE_DIRECTORY_ENTRY_DEBUG"
            ],
            "description": "PE file contains a debug data directory",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "238",
            "match_data": [
              "http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0",
              "http://cacerts.digicert.com/DigiCertSHA2AssuredIDCodeSigningCA.crt0",
              "http://cacerts.digicert.com/DigiCertSHA2AssuredIDTimestampingCA.crt0",
              "http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0O",
              "http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0P",
              "http://crl3.digicert.com/sha2-assured-cs-g1.crl05",
              "http://crl3.digicert.com/sha2-assured-ts.crl02",
              "http://crl4.digicert.com/DigiCertAssuredIDRootCA.crl0:",
              "http://crl4.digicert.com/sha2-assured-cs-g1.crl0K",
              "http://crl4.digicert.com/sha2-assured-ts.crl0",
              "http://ocsp.digicert.com0C",
              "http://ocsp.digicert.com0N",
              "http://ocsp.digicert.com0O",
              "http://www.digicert.com/CPS0",
              "https://www.digicert.com/CPS0"
            ],
            "description": "URLs found in memory or binary data",
            "severity": "IMPACT_SEVERITY_INFO"
          },
          {
            "id": "90",
            "match_data": [
              "C:\\Users\\user\\Desktop\\320946.lrm"
            ],
            "description": "Creates files inside the user directory",
            "severity": "IMPACT_SEVERITY_INFO"
          }
        ],
        "verdict_confidence": 98,
        "files_written": [
          "C:\\Users\\user\\Desktop\\320946.lrm",
          "\\Device\\ConDrv\\\\Connect"
        ],
        "sandbox_name": "Zenbox",
        "registry_keys_opened": [
          "HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
          "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ProductOptions",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
          "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
          "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
          "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Rpc",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
          "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
          "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
          "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
          "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\LicRCmd.exe",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
          "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
          "HKEY_LOCAL_MACHINE\\System\\Setup",
          "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows NT\\Rpc",
          "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
          "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
          "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
          "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
          "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
          "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
          "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\ComputerName\\ActiveComputerName",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\ComputerName",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
          "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option"
        ],
        "analysis_date": 1707523580
      }
    }
  ],
  "meta": {
    "count": 5
  },
  "links": {
    "self": "https://www.virustotal.com/api/v3/files/4f618988ca007412ab96f34337a58fe3e14dec468bc60ca8eedacd0ce76e9628/behaviours?limit=10"
  }
}
